# JMT Player 开发进展文档

## 项目信息
- **项目名称**: 济民堂播放器 (JMT Player)
- **当前版本**: 1.6.1
- **仓库**: https://github.com/Cooanyh/JMT-Player

## v1.6.1 更新 (2026-01-01)

### 更新内容
1. ✅ **修复自动播放功能**
   - 修正播放按钮选择器为 `#play-toggle-button-desktop`
   - 使用 FontAwesome 图标类判断播放状态
   - 支持多种按钮选择器回退机制
2. ✅ **"仅音乐模式"弹窗提示**
   - 用户点击"仅音乐模式"后显示 Toast 提示
   - 提示内容: "广告语将在本轮播放后结束，仅音乐播放"

### 技术实现
- `initPlaybackControl()` 更新按钮选择器
- 新增 `initMusicOnlyModeNotification()` 函数
- 弹窗动画使用 CSS 过渡和 cubic-bezier

---

## v1.6.0 更新 (2025-12-31)

### 更新内容
1. ✅ **更新源切换至 Gitee**
   - 使用 generic provider 指向 Gitee releases
   - 解决国内用户更新下载慢的问题
2. ✅ **启动弹窗引导更新**
   - 检测到新版本时弹窗提示用户更新
   - 用户选择"稍后"则下次启动继续提醒
   - 直到用户更新后不再显示

### 技术实现
- `pendingUpdateVersion` 持久化存储待更新版本
- `showUpdateDialog` 弹窗引导函数
- 支持 Gitee releases 下载链接

---

## v1.5.0 更新 (2025-12-31)

### 更新内容
1. ✅ **播放可靠性增强**
   - 电源保持锁：防止系统休眠、息屏时中断播放
   - 禁用后台节流：保持应用在后台时持续活跃
   - Windows API 级防休眠：每5分钟刷新防休眠状态
2. ✅ **页面加载失败自动恢复**
   - 监测页面加载失败自动重载
   - 重新加载后自动触发播放
3. ✅ **播放保持机制**
   - 监控播放状态，检测异常中断自动恢复
   - 心跳检测：主进程每30秒检测渲染进程状态
   - 阻止页面可见性变化导致的后台节流

### 技术实现
- `powerSaveBlocker` 防止应用挂起和显示器休眠
- `SetThreadExecutionState` Windows API 调用
- 心跳检测 IPC 机制

---

## v1.4.0 更新 (2025-12-31)

### 更新内容

---

## v1.3.0 更新 (2025-12-31)

### 更新内容
1. ✅ 混音功能重定向到浏览器（点击混音按钮会打开浏览器）
2. ✅ 页面崩溃自动恢复
3. ✅ Blob 下载支持
4. ✅ 增加内存限制和跨域音频支持

### 构建产物
- `济民堂播放器 1.3.0.exe` - 便携版
- `济民堂播放器 Setup 1.3.0.exe` - 安装程序

---

## v1.2.0 更新 (2025-12-31)

### 更新内容
1. ✅ 修复下载功能白屏问题
2. ✅ 托盘图标左键单击打开主界面
3. ✅ 托盘右键菜单新增"刷新页面"选项

---

## 历史版本
- v1.1.0: 中文名称、新Logo、音量控制修复、MIT License
- v1.0.0: 初始版本

---
*更新时间: 2025-12-31*
